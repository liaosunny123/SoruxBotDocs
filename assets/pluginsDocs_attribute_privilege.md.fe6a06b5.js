import{_ as s,c as a,o as n,a as e}from"./app.a5da328c.js";const d=JSON.parse('{"title":"Privilege特性","description":"","frontmatter":{},"headers":[{"level":2,"title":"基本介绍","slug":"基本介绍","link":"#基本介绍","children":[]},{"level":2,"title":"特性使用","slug":"特性使用","link":"#特性使用","children":[]},{"level":2,"title":"API使用","slug":"api使用","link":"#api使用","children":[{"level":3,"title":"泛型API","slug":"泛型api","link":"#泛型api","children":[]},{"level":3,"title":"特殊API","slug":"特殊api","link":"#特殊api","children":[]}]}],"relativePath":"pluginsDocs/attribute/privilege.md"}'),o={name:"pluginsDocs/attribute/privilege.md"},l=e(`<h1 id="privilege特性" tabindex="-1">Privilege特性 <a class="header-anchor" href="#privilege特性" aria-hidden="true">#</a></h1><h2 id="基本介绍" tabindex="-1">基本介绍 <a class="header-anchor" href="#基本介绍" aria-hidden="true">#</a></h2><p>关于 Privilege 特性的基本介绍可参见 <a href="./../json.html">Json页</a> 。</p><h2 id="特性使用" tabindex="-1">特性使用 <a class="header-anchor" href="#特性使用" aria-hidden="true">#</a></h2><ul><li>插件的<code>Register</code>继承<code>ICommandPrefix</code>接口</li><li>插件使用<code>PermissionAttribute</code>作为特性标记</li><li>在Json中注册你的特性</li></ul><h2 id="api使用" tabindex="-1">API使用 <a class="header-anchor" href="#api使用" aria-hidden="true">#</a></h2><p>按照<code>SoruxBot</code>的设计逻辑，API分为泛型API和基础API。</p><h3 id="泛型api" tabindex="-1">泛型API <a class="header-anchor" href="#泛型api" aria-hidden="true">#</a></h3><p><strong>增删某物体权限</strong></p><div class="language-csharp"><button title="Copy Code" class="copy"></button><span class="lang">csharp</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">bool</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">AddGenericPermission</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">MessageContext</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">context</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">PermissionType</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">permissionType</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">string</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">permissionChar</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">string</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">node</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span></code></pre></div><div class="language-csharp"><button title="Copy Code" class="copy"></button><span class="lang">csharp</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">bool</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">RemoveGenericPermission</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">MessageContext</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">context</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">PermissionType</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">permissionType</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">string</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">permissionChar</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">string</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">node</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span></code></pre></div><p>以上分别是增删某个权限的泛型API，可作为通用API使用。</p><ul><li>MessageContext ： 消息的上下文，需要传入以供分析节点</li><li>PermissionType ： 需要被解析的对象</li><li>PermissionChar ： 表示关键词的字面值</li><li>node ： 权限节点</li></ul><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>关于 PermissionChar 和 node 的使用可以见下文对一个特殊 API 的分析</p></div><p><strong>查询某物体权限</strong></p><div class="language-csharp"><button title="Copy Code" class="copy"></button><span class="lang">csharp</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">string</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">GetGenericPermission</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">MessageContext</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">context</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">string</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">obj</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span></code></pre></div><p><strong>得到某物体权限</strong></p><div class="language-csharp"><button title="Copy Code" class="copy"></button><span class="lang">csharp</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">bool</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">GenericHasPermission</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">MessageContext</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">context</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">PermissionType</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">permissionType</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">string</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">permissionChar</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">string</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">node</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span></code></pre></div><h3 id="特殊api" tabindex="-1">特殊API <a class="header-anchor" href="#特殊api" aria-hidden="true">#</a></h3><p>例如，我们以增加某物体权限为例：</p><div class="language-csharp"><button title="Copy Code" class="copy"></button><span class="lang">csharp</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">bool</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">AddTriggerIdPermission</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">MessageContext</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">context</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">string</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">node</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;">  </span></span>
<span class="line"><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;">  </span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">AddGenericPermission</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">context</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> PermissionType</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">BasicPermission</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">TriggerId</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> node</span><span style="color:#89DDFF;">);</span><span style="color:#A6ACCD;">  </span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><p>以下为设计的逻辑：</p><ol><li>需要设计一个判断个人是否有触发条件的权限节点，并在MessageContext中找到了这个属性，其为<code>TriggerId</code></li><li>由于<code>TriggerId</code>与平台无关，所以其直接暴露在<code>MessageContext</code>中，而非<code>UnderLayModel</code>，因此选择<code>BasicPermission</code></li><li><code>TriggerId</code>的字面值为<code>TriggerId</code>，如果是<code>UnderLayModel</code>中的字段，那么需要填写相应的字段</li><li><code>node</code>为任意字符，但是我们推荐采用插件域名反写+个性化字段的命名逻辑，如<code>cn.epicmo.plugins.command.say</code>其中<code>say</code>为个性化字段，多个个性化字段之间使用<code>.</code>相连接</li></ol>`,23),p=[l];function t(r,c,i,y,C,F){return n(),a("div",null,p)}const A=s(o,[["render",t]]);export{d as __pageData,A as default};
