import{_ as s,c as n,o as a,a as l}from"./app.a5da328c.js";const i=JSON.parse('{"title":"插件示例开发","description":"","frontmatter":{},"headers":[{"level":2,"title":"概述","slug":"概述","link":"#概述","children":[]},{"level":2,"title":"开发之前","slug":"开发之前","link":"#开发之前","children":[]},{"level":2,"title":"注册插件Register","slug":"注册插件register","link":"#注册插件register","children":[]},{"level":2,"title":"完成一个最基本的Controller","slug":"完成一个最基本的controller","link":"#完成一个最基本的controller","children":[]},{"level":2,"title":"制作Json","slug":"制作json","link":"#制作json","children":[]},{"level":2,"title":"运行插件","slug":"运行插件","link":"#运行插件","children":[]}],"relativePath":"pluginsDocs/example/index.md"}'),p={name:"pluginsDocs/example/index.md"},o=l(`<h1 id="插件示例开发" tabindex="-1">插件示例开发 <a class="header-anchor" href="#插件示例开发" aria-hidden="true">#</a></h1><h2 id="概述" tabindex="-1">概述 <a class="header-anchor" href="#概述" aria-hidden="true">#</a></h2><p>本文将以开发者的视角开发一个通用平台的一言插件。</p><h2 id="开发之前" tabindex="-1">开发之前 <a class="header-anchor" href="#开发之前" aria-hidden="true">#</a></h2><p>首先，我们需要在项目的Release下载我们需要的Wrapper和Provider版本，在本文中我们仅以QQ平台作为我们的示例开发平台。</p><p>然后我们需要新建一个<code>.NET 6.0 Libraries</code>项目，并导入<code>Interface</code>的DLL引用。</p><p>当你可以引用Sorux的命名空间时，说明我们可以开始我们的开发了。</p><h2 id="注册插件register" tabindex="-1">注册插件Register <a class="header-anchor" href="#注册插件register" aria-hidden="true">#</a></h2><p>创建一个Register类，并实现IBasicInformation接口。由于此插件有命令触发前缀的需求，因此我们同时也实现ICommandPrefix接口。</p><p>填写基本信息：</p><div class="language-csharp"><button title="Copy Code" class="copy"></button><span class="lang">csharp</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">class</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Register</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">IBasicInformationRegister</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">ICommandPrefix</span><span style="color:#A6ACCD;">  </span></span>
<span class="line"><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;">  </span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">string</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">GetAuthor</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">EpicMo</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;">  </span></span>
<span class="line"><span style="color:#A6ACCD;">  </span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">string</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">GetDescription</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">用于信息的手机、整理</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;">  </span></span>
<span class="line"><span style="color:#A6ACCD;">  </span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">string</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">GetName</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">InformationCollector</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;">  </span></span>
<span class="line"><span style="color:#A6ACCD;">  </span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">string</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">GetVersion</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">1.0.0-release</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;">  </span></span>
<span class="line"><span style="color:#A6ACCD;">  </span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">string</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">GetDLL</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">EpicMo.Plugins.InformationCollector.dll</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;">  </span></span>
<span class="line"><span style="color:#A6ACCD;">  </span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">string</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">GetCommandPrefix</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">#</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;">  </span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><p>其中，GetDLL()的返回值便是我们最后编译出来的DLL名称。</p><h2 id="完成一个最基本的controller" tabindex="-1">完成一个最基本的Controller <a class="header-anchor" href="#完成一个最基本的controller" aria-hidden="true">#</a></h2><p>因为此插件只需要对接一言接口，因此我们只需要一个基本的Controller类即可。</p><p>首先，建立我们的类，并继承BotController接口：</p><div class="language-csharp"><button title="Copy Code" class="copy"></button><span class="lang">csharp</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">class</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">YiYanController</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">BotController</span><span style="color:#A6ACCD;">  </span></span>
<span class="line"><span style="color:#89DDFF;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><p>接着便是向框架请求相应的服务，因为我们需要向用户发送信息，因此我们需要请求BasicAPI服务，此外，我们可能会有日志记录的要求，因此我们也请求ILoggerService服务：</p><div class="language-csharp"><button title="Copy Code" class="copy"></button><span class="lang">csharp</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">class</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">YiYanController</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">BotController</span><span style="color:#A6ACCD;">  </span></span>
<span class="line"><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;">  </span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">private</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">ILoggerService</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">_loggerService</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;">  </span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">private</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">IBasicAPI</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">_bot</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;">  </span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">private</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">RestClient</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">_client</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;">  </span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">YiYanController</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">ILoggerService</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">loggerService</span><span style="color:#89DDFF;">,</span><span style="color:#FFCB6B;">IBasicAPI</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">bot</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;">  </span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;">        </span></span>
<span class="line"><span style="color:#A6ACCD;">	    </span><span style="color:#F78C6C;">this</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">_loggerService </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> loggerService</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;">  </span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F78C6C;">this</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">_bot </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> bot</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;">  </span></span>
<span class="line"><span style="color:#A6ACCD;">        _client </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">RestClient</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">https://v1.hitokoto.cn/</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span><span style="color:#A6ACCD;">  </span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><p>在这个地方，我们除了请求两个服务外，还在Controller中执行了初始化任务。</p><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>相较于以插件启用/禁用时调用插件的OnEnable和OnDisable方法，SoruxBot认为一个插件的最基本单位应该是功能集，而不是插件整体。因此，当你有初始化某个功能集的一些服务的需求时，请在Controller执行初始化服务。</p></div><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>特别的，插件的每一个Controller只会初始化一次，且初始化时间在所有消息和Action执行之前，由框架统一初始化</p></div><p>然后，分析我们的需求，我们在插件中需要提供一个命令，让在群聊中的用户能够触发得到一言句子的Action，同时，在一言的API文档中，我们发现我们可以手动指定得到句子的类型。</p><p>也就是我们既可以直接向一言请求句子，也可以指定句子类型再请求，那么我们的命令参数就应该是包含一个可选参数的命令。因此我们可以得到一个Action雏形:</p><div class="language-csharp"><button title="Copy Code" class="copy"></button><span class="lang">csharp</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">[</span><span style="color:#FFCB6B;">Event</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">EventType</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">GroupMessage</span><span style="color:#89DDFF;">)]</span><span style="color:#A6ACCD;">  </span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#FFCB6B;">Command</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">CommandAttribute</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">Prefix</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">Single</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">saying &lt;type&gt;</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)]</span><span style="color:#A6ACCD;">  </span></span>
<span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">PluginFucFlag</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">YiYanGet</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">MessageContext</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">context</span><span style="color:#89DDFF;">,string?</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">type</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;">  </span></span>
<span class="line"><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><p>在这个Action里面，我们指定了命令的前缀是Single，也就是插件本身向框架注册的前缀，这个前缀就是你在Register里面指定的<code>GetCommandPrefix()</code>，此外，由于type是一个可选参数，因此由<code>&lt;&gt;</code>包围，而不是<code>[]</code>，并且由于type为可选参数，因此他可空。关于插件的参数说明，可见插件的<a href="/SoruxBotDocs/pluginsDocs/attribute/command.html">命令特性</a>，关于插件的触发条件，可见插件的<a href="/SoruxBotDocs/pluginsDocs/attribute/event.html">事件特性</a>。</p><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>虽然string本身可以为null，但是我们建议你声明可空类型string?而不是string。</p></div><p>由于我们只想本插件在saying被触发后执行，因此我们返回一个拦截消息请求，防止多个插件被触发。关于插件其他的返回请求请见<a href="/SoruxBotDocs/pluginsDocs/returnType.html">插件的返回说明</a></p><div class="language-csharp"><button title="Copy Code" class="copy"></button><span class="lang">csharp</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">[</span><span style="color:#FFCB6B;">Event</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">EventType</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">GroupMessage</span><span style="color:#89DDFF;">)]</span><span style="color:#A6ACCD;">  </span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#FFCB6B;">Command</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">CommandAttribute</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">Prefix</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">Single</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">saying &lt;type&gt;</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)]</span><span style="color:#A6ACCD;">  </span></span>
<span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">PluginFucFlag</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">YiYanGet</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">MessageContext</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">context</span><span style="color:#89DDFF;">,string?</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">type</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;">  </span></span>
<span class="line"><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#A6ACCD;"> PluginFucFlag</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">MsgIntercepted</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>这一种做法也可能被其他使用saying指令的Action操作。而遇到这个情况是本插件执行还是另一个插件执行，由插件配置中的优先级决定。关于优先级的说明可以见插件的<a href="/SoruxBotDocs/pluginsDocs/json.html">Json配置说明</a></p></div><p>然后，我们需要具体编写Action的内容，这不是本文重点，因此我们直接给出代码：</p><div class="language-csharp"><button title="Copy Code" class="copy"></button><span class="lang">csharp</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">[</span><span style="color:#FFCB6B;">Event</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">EventType</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">GroupMessage</span><span style="color:#89DDFF;">)]</span><span style="color:#A6ACCD;">  </span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#FFCB6B;">Command</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">CommandAttribute</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">Prefix</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">Single</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">saying &lt;type&gt;</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)]</span><span style="color:#A6ACCD;">  </span></span>
<span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">PluginFucFlag</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">YiYanGet</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">MessageContext</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">context</span><span style="color:#89DDFF;">,string?</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">type</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;">  </span></span>
<span class="line"><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;">  </span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">var</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">request</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">RestRequest</span><span style="color:#89DDFF;">();</span><span style="color:#A6ACCD;">  </span></span>
<span class="line"><span style="color:#A6ACCD;">    request</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">Method </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> Method</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">Get</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;">  </span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(!</span><span style="color:#A6ACCD;">string</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">IsNullOrEmpty</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">type</span><span style="color:#89DDFF;">))</span><span style="color:#A6ACCD;">  </span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;">        </span></span>
<span class="line"><span style="color:#A6ACCD;">	    request</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">AddQueryParameter</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">c</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> type</span><span style="color:#89DDFF;">);</span><span style="color:#A6ACCD;">  </span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">    </span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">var</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">result</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> _client</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Execute</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">request</span><span style="color:#89DDFF;">);</span><span style="color:#A6ACCD;">  </span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#FFCB6B;">YiYan</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">model</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> JsonConvert</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">DeserializeObject</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">YiYan</span><span style="color:#89DDFF;">&gt;(</span><span style="color:#A6ACCD;">result</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">Content</span><span style="color:#89DDFF;">!)!;</span><span style="color:#A6ACCD;">  </span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(!</span><span style="color:#A6ACCD;">string</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">IsNullOrEmpty</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">model</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">from_who</span><span style="color:#89DDFF;">))</span><span style="color:#A6ACCD;">  </span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;">        </span></span>
<span class="line"><span style="color:#A6ACCD;">	    _bot</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">SendGroupMessage</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">context</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;">model</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">hitokoto </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">   ---</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> model</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">from_who</span><span style="color:#89DDFF;">);</span><span style="color:#A6ACCD;">  </span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">    </span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;font-style:italic;">else</span><span style="color:#A6ACCD;">  </span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;">  </span></span>
<span class="line"><span style="color:#A6ACCD;">        _bot</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">SendGroupMessage</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">context</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;">model</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">hitokoto</span><span style="color:#89DDFF;">);</span><span style="color:#A6ACCD;">  </span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">    </span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#A6ACCD;"> PluginFucFlag</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">MsgIntercepted</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;">  </span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><p>在Action中，我们可以使用插件的BasicAPI来帮助我们快速的发送消息。在SoruxBot的体系中，API分为通用API和特定API，由于我们编写的插件是多平台的，因此使用BasicAPI的基本服务即可，可见我们的<code>SendGroupMessage</code>中并未包含任何与QQ聊天平台有关的信息，这也说明了我们的插件可以服务多个聊天平台。</p><p>在Action中，我们定义了一个YiYan，这个作为Json反序列化的模板。</p><h2 id="制作json" tabindex="-1">制作Json <a class="header-anchor" href="#制作json" aria-hidden="true">#</a></h2><div class="language-json"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">Name</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">YiYan</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">Privilege</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">PermissionNode</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:[],</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">PermissionDefaultConfig</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:[]</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><p>我们制作了一个最基本的Json，并让我们的默认优先级为1。关于Json的详细说明可以见<a href="/SoruxBotDocs/pluginsDocs/json.html">插件Json说明</a></p><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>优先级是可以被用户更改的，因此我们无法保证运行时也是1。关于优先级冲突的叙述请见<a href="/SoruxBotDocs/pluginsDocs/json.html">插件Json说明</a></p></div><h2 id="运行插件" tabindex="-1">运行插件 <a class="header-anchor" href="#运行插件" aria-hidden="true">#</a></h2><p>将插件放置在<code>Wrapper/Plugins/Bin</code>中，将Json放置在<code>Wrapper/Plugins/Config</code>中，然后重启Wrapper，并打开Provider.Cqhttp和Go-cqhttp，我们便完成了插件的运行。</p>`,39),e=[o];function t(c,r,D,C,y,F){return a(),n("div",null,e)}const u=s(p,[["render",t]]);export{i as __pageData,u as default};
